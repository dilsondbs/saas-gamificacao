import{r as o,j as a,F as T,a as e,S as L,x,b as P,A as D}from"./app-2033c2ba.js";function H({step1Data:w,step2Data:h,step3Data:G,planPrice:V,isFree:p,tenantInfo:C,creation_id:S}){const[g,d]=o.useState(!!S),[E,_]=o.useState(!!C),[c,R]=o.useState(C),[m,I]=o.useState(S),[j,l]=o.useState(null),[k,b]=o.useState(!1),[z,$]=o.useState([{id:"validating",name:"Validando dados",status:"pending"},{id:"creating_database",name:"Criando base de dados",status:"pending"},{id:"configuring_domain",name:"Configurando domínio",status:"pending"},{id:"running_migrations",name:"Executando migrações",status:"pending"},{id:"creating_admin",name:"Criando usuário administrador",status:"pending"},{id:"seeding_data",name:"Configurando dados iniciais",status:"pending"},{id:"health_check",name:"Validando integridade",status:"pending"}]),v=(t,r)=>{$(f=>f.map(u=>u.id===t?{...u,status:r}:u))},M=async t=>{var r,f,u;try{const s=await P.get(`/signup/creation-status/${t}`,{headers:{"X-CSRF-TOKEN":(r=document.querySelector('meta[name="csrf-token"]'))==null?void 0:r.getAttribute("content"),Accept:"application/json","Content-Type":"application/json"}});if(s.data.success){const n=s.data.status;if(n.current_step&&n.status==="running"){v(n.current_step,"processing");const i=["validating","creating_database","configuring_domain","running_migrations","creating_admin","seeding_data","health_check"],B=i.indexOf(n.current_step);for(let y=0;y<B;y++)v(i[y],"completed")}if(n.status==="completed"){if(z.forEach(i=>{v(i.id,"completed")}),n.result){R(n.result),_(!0),d(!1);return}try{const i=await P.get(`/api/tenant-creation-result/${t}`,{headers:{"X-CSRF-TOKEN":(f=document.querySelector('meta[name="csrf-token"]'))==null?void 0:f.getAttribute("content"),Accept:"application/json","Content-Type":"application/json"}});if(i.data.success){R(i.data.result),_(!0),d(!1);return}}catch(i){console.warn("Could not fetch final result:",i)}window.location.href=`/signup/step4?created=true&slug=${h.tenant_slug}`;return}if(n.status==="failed"){l(n.message||"Erro na criação da plataforma"),d(!1);return}(n.status==="running"||n.status==="started")&&setTimeout(()=>M(t),2e3)}else l("Erro ao verificar status da criação"),d(!1)}catch(s){console.error("Error checking creation status:",s),s.response?(console.error("Error response status:",s.response.status),console.error("Error response data:",s.response.data),s.response.status===419?l("Erro de segurança (CSRF). Recarregue a página e tente novamente."):l(`Erro do servidor (${s.response.status}): ${((u=s.response.data)==null?void 0:u.message)||"Erro desconhecido"}`)):s.request?(console.error("Error request:",s.request),l("Erro de rede. Verifique sua conexão.")):(console.error("Error message:",s.message),l("Erro de comunicação com servidor")),d(!1)}};o.useEffect(()=>{m&&!E&&(console.log("Starting auto-polling for creation_id:",m),d(!0),l(null),M(m))},[m]),o.useEffect(()=>{if(g&&m){const t=setTimeout(()=>{b(!0),l("Tempo limite excedido. A criação pode ainda estar em andamento. Verifique seu email ou tente acessar a plataforma em alguns minutos.")},12e4);return()=>clearTimeout(t)}},[g,m]);const A=()=>{d(!0),l(null),b(!1),D.post("/signup/start-creation",{},{onError:t=>{console.error("Error starting creation:",t),l("Erro ao iniciar criação. Tente novamente."),d(!1)},onSuccess:()=>{}})},q=()=>{l(null),b(!1),I(null),$(t=>t.map(r=>({...r,status:"pending"}))),A()},N=[{number:1,title:"Informações da Empresa",completed:!0},{number:2,title:"Configuração do Tenant",completed:!0},{number:3,title:"Pagamento",completed:!p},{number:4,title:"Confirmação",active:!0}];return E&&c?a(T,{children:[e(L,{title:"Tenant Criado com Sucesso!"}),a("div",{className:"min-h-screen bg-gradient-to-br from-green-50 via-blue-50 to-indigo-50 flex items-center justify-center relative overflow-hidden",children:[e("div",{className:"absolute inset-0 pointer-events-none",children:[...Array(20)].map((t,r)=>e("div",{className:`absolute w-3 h-3 ${["bg-yellow-400","bg-pink-400","bg-blue-400","bg-green-400","bg-purple-400"][r%5]} rounded-full animate-bounce opacity-70`,style:{left:`${Math.random()*100}%`,top:`${Math.random()*100}%`,animationDelay:`${Math.random()*2}s`,animationDuration:`${2+Math.random()*2}s`}},r))}),e("div",{className:"max-w-2xl mx-auto px-4 text-center relative z-10",children:a("div",{className:"bg-white/95 backdrop-blur-sm rounded-2xl shadow-2xl p-8 border border-white/20",children:[e("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e("svg",{className:"w-8 h-8 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e("h1",{className:"text-4xl font-bold bg-gradient-to-r from-green-600 to-blue-600 bg-clip-text text-transparent mb-4",children:"🎉 Plataforma Criada com Sucesso!"}),e("p",{className:"text-gray-600 mb-8",children:"Sua plataforma de gamificação educacional está pronta para uso!"}),a("div",{className:"bg-gray-50 rounded-lg p-6 mb-6 text-left",children:[e("h3",{className:"font-semibold text-gray-900 mb-4",children:"Informações de Acesso:"}),a("div",{className:"space-y-3",children:[a("div",{children:[e("span",{className:"text-sm font-medium text-gray-700",children:"URL da Plataforma:"}),e("div",{className:"mt-1",children:e("a",{href:c.login_url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 font-mono text-sm break-all",children:c.login_url})})]}),a("div",{children:[e("span",{className:"text-sm font-medium text-gray-700",children:"Email de Login:"}),e("div",{className:"mt-1 font-mono text-sm text-gray-900",children:c.credentials.email})]}),a("div",{children:[e("span",{className:"text-sm font-medium text-gray-700",children:"Senha Temporária:"}),e("div",{className:"mt-1 font-mono text-sm text-gray-900",children:c.credentials.password}),e("p",{className:"text-xs text-orange-600 mt-1",children:"⚠️ Altere sua senha após o primeiro login"})]})]})]}),a("div",{className:"grid md:grid-cols-2 gap-4 mb-8",children:[a("div",{className:"bg-blue-50 rounded-lg p-4",children:[e("h4",{className:"font-semibold text-blue-900 mb-2",children:"📧 Próximos Passos"}),a("ul",{className:"text-sm text-blue-800 space-y-1 text-left",children:[e("li",{children:"• Altere sua senha no primeiro login"}),e("li",{children:"• Configure seu perfil de administrador"}),e("li",{children:"• Crie seus primeiros cursos"}),e("li",{children:"• Convide instrutores e alunos"})]})]}),a("div",{className:"bg-purple-50 rounded-lg p-4",children:[e("h4",{className:"font-semibold text-purple-900 mb-2",children:"🚀 Recursos Disponíveis"}),a("ul",{className:"text-sm text-purple-800 space-y-1 text-left",children:[e("li",{children:"• Sistema de gamificação"}),e("li",{children:"• Gerenciamento de cursos"}),e("li",{children:"• Dashboard com analytics"}),e("li",{children:"• Suporte técnico incluído"})]})]})]}),a("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[a("a",{href:c.login_url,target:"_blank",rel:"noopener noreferrer",className:"relative px-8 py-4 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:from-blue-700 hover:to-purple-700 transition-all duration-300 text-center font-bold text-lg shadow-lg transform hover:scale-105 overflow-hidden group",children:[e("span",{className:"relative z-10 flex items-center justify-center",children:"🔑 Acessar Minha Plataforma"}),e("div",{className:"absolute inset-0 bg-gradient-to-r from-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"})]}),e(x,{href:"/",className:"px-8 py-4 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-all duration-300 text-center transform hover:scale-105 hover:shadow-md",children:"🏠 Voltar ao Início"})]}),a("div",{className:"absolute inset-0 pointer-events-none overflow-hidden",children:[e("div",{className:"absolute top-1/4 left-1/4 w-2 h-2 bg-yellow-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),e("div",{className:"absolute top-1/3 right-1/3 w-1 h-1 bg-pink-400 rounded-full animate-bounce",style:{animationDelay:"0.3s"}}),e("div",{className:"absolute bottom-1/4 left-1/3 w-1.5 h-1.5 bg-blue-400 rounded-full animate-bounce",style:{animationDelay:"0.5s"}}),e("div",{className:"absolute bottom-1/3 right-1/4 w-1 h-1 bg-purple-400 rounded-full animate-bounce",style:{animationDelay:"0.7s"}})]})]})})]})]}):a(T,{children:[e(L,{title:"Confirmação - Etapa 4"}),a("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50",children:[e("nav",{className:"bg-white/95 backdrop-blur-sm border-b border-gray-200",children:e("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e("div",{className:"flex justify-between h-16 items-center",children:a(x,{href:"/",className:"flex items-center space-x-2",children:[e("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-600 to-purple-600 rounded-lg flex items-center justify-center",children:e("span",{className:"text-white font-bold text-sm",children:"SG"})}),e("span",{className:"font-bold text-xl text-gray-900",children:"SaaS Gamificação"})]})})})}),a("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[e("div",{className:"mb-8",children:e("nav",{"aria-label":"Progress",children:e("ol",{className:"flex items-center",children:N.map((t,r)=>a("li",{className:`${r!==N.length-1?"pr-8 sm:pr-20":""} relative`,children:[a("div",{className:"flex items-center",children:[e("div",{className:`flex items-center justify-center w-10 h-10 rounded-full border-2 ${t.completed||t.active?"bg-blue-600 border-blue-600 text-white":"border-gray-300 bg-white text-gray-500"}`,children:t.completed?e("svg",{className:"w-6 h-6",fill:"currentColor",viewBox:"0 0 20 20",children:e("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):e("span",{className:"text-sm font-medium",children:t.number})}),e("div",{className:"ml-4 hidden sm:block",children:e("div",{className:`text-sm font-medium ${t.completed||t.active?"text-blue-600":"text-gray-500"}`,children:t.title})})]}),r!==N.length-1&&e("div",{className:"hidden sm:block absolute top-5 left-10 w-full h-0.5",style:{backgroundColor:t.completed?"#2563eb":"#e5e7eb"}})]},t.number))})})}),e("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden",children:a("div",{className:"p-8 text-center",children:[e("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e("svg",{className:"w-8 h-8 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})})}),e("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Tudo pronto para finalizar!"}),e("p",{className:"text-gray-600 mb-8",children:p?"Seu teste gratuito será criado em instantes.":"Confirme os dados e finalize seu pedido."}),a("div",{className:"bg-gray-50 rounded-lg p-6 mb-8 text-left max-w-md mx-auto",children:[e("h3",{className:"font-semibold text-gray-900 mb-4 text-center",children:"Resumo do Pedido"}),a("div",{className:"space-y-3",children:[a("div",{className:"flex justify-between",children:[e("span",{className:"text-gray-600",children:"Empresa:"}),e("span",{className:"font-medium",children:w.company_name})]}),a("div",{className:"flex justify-between",children:[e("span",{className:"text-gray-600",children:"Plataforma:"}),e("span",{className:"font-medium",children:h.tenant_name})]}),a("div",{className:"flex justify-between",children:[e("span",{className:"text-gray-600",children:"URL:"}),a("span",{className:"font-medium text-sm",children:[h.tenant_slug,".saas-gamificacao.local"]})]}),a("div",{className:"flex justify-between",children:[e("span",{className:"text-gray-600",children:"Plano:"}),e("span",{className:"font-medium uppercase",children:w.plan})]}),a("div",{className:"flex justify-between border-t pt-3",children:[e("span",{className:"text-gray-600",children:"Valor:"}),e("span",{className:"font-bold text-lg",children:p?"Grátis":`R$ ${V}/mês`})]})]})]}),g?a("div",{className:"space-y-4",children:[a("div",{className:"text-center mb-6",children:[e("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a("svg",{className:"animate-spin w-8 h-8 text-blue-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]})}),e("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Criando sua plataforma..."}),e("p",{className:"text-gray-600",children:"Este processo pode levar alguns minutos."})]}),e("div",{className:"bg-gray-50 rounded-lg p-6",children:e("div",{className:"space-y-3",children:z.map((t,r)=>a("div",{className:"flex items-center",children:[e("div",{className:`w-6 h-6 rounded-full flex items-center justify-center mr-3 ${t.status==="completed"?"bg-green-500 text-white":t.status==="processing"?"bg-blue-500 text-white":"bg-gray-200 text-gray-500"}`,children:t.status==="completed"?e("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:e("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}):t.status==="processing"?a("svg",{className:"animate-spin w-3 h-3",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):e("span",{className:"text-xs",children:r+1})}),e("span",{className:`text-sm ${t.status==="completed"?"text-green-700 font-medium":t.status==="processing"?"text-blue-700 font-medium":"text-gray-600"}`,children:t.name})]},t.id))})})]}):j?a("div",{className:"space-y-4",children:[e("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:a("div",{className:"flex",children:[e("div",{className:"flex-shrink-0",children:e("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),a("div",{className:"ml-3",children:[e("h3",{className:"text-sm font-medium text-red-800",children:"Erro na Criação da Plataforma"}),e("div",{className:"mt-2 text-sm text-red-700",children:e("p",{children:j})})]})]})}),a("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[e("button",{onClick:q,className:"relative px-8 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all duration-300 font-semibold shadow-lg transform hover:scale-105",children:"🔄 Tentar Novamente"}),k&&e("button",{onClick:()=>window.location.href="/signup/step2",className:"px-8 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-all duration-300 transform hover:scale-105",children:"← Voltar para Editar"}),e(x,{href:"/",className:"px-8 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-all duration-300 text-center transform hover:scale-105",children:"🏠 Ir para Início"})]}),k&&e("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:a("div",{className:"flex",children:[e("div",{className:"flex-shrink-0",children:e("svg",{className:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor",children:e("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),a("div",{className:"ml-3",children:[e("h3",{className:"text-sm font-medium text-yellow-800",children:"Informação Importante"}),e("div",{className:"mt-2 text-sm text-yellow-700",children:a("p",{children:["Se o processo estava quase concluído, sua plataforma pode ter sido criada com sucesso. Aguarde alguns minutos e tente acessar: ",e("br",{}),a("strong",{className:"font-mono text-xs",children:["http://",h.tenant_slug,".saas-gamificacao.local:8000"]})]})})]})]})})]}):a("button",{onClick:A,disabled:g,className:"relative px-10 py-5 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-xl hover:from-green-600 hover:to-emerald-700 transition-all duration-300 text-xl font-bold disabled:opacity-50 disabled:cursor-not-allowed shadow-xl transform hover:scale-105 overflow-hidden group",children:[e("span",{className:"relative z-10 flex items-center justify-center",children:"🚀 Criar Minha Plataforma"}),e("div",{className:"absolute inset-0 bg-gradient-to-r from-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e("div",{className:"absolute -inset-1 bg-gradient-to-r from-green-400 to-emerald-500 rounded-xl blur opacity-30 group-hover:opacity-60 transition-opacity duration-300"})]}),e("div",{className:"flex justify-center mt-6",children:e(x,{href:p?"/signup/step2":"/signup/step3",className:"px-6 py-2 text-gray-600 hover:text-gray-900 transition-colors text-sm",children:"← Voltar para editar"})})]})})]})]})]})}export{H as default};
